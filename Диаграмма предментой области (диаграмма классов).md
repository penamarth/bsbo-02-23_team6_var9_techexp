<img width="2079" height="1692" alt="image" src="https://github.com/user-attachments/assets/6e865b9a-54e0-4cd5-a64a-c1c3c236adf1" />


```
@startuml
skinparam class {
    BackgroundColor<<Interface>> #E6F3FF
    BackgroundColor<<Entity>> #FFFFFF
    BackgroundColor<<Facade>> #E8F5E8
    BackgroundColor<<Repository>> #FFF4E6
    BackgroundColor<<Service>> #FFF0F5
    BackgroundColor<<DTO>> #F0FFF0
    BorderColor #666666
    ArrowColor #444444
}

skinparam package {
    BackgroundColor<<Main>> #F5F5F5
    BackgroundColor<<Support>> #F0F8FF
    BorderColor #888888
}

' ========== UI ==========
class GrantSystemUI {
  + main()
  + showLoginScreen()
  + showDashboard()
  + showApplicationForm()
  + showReviewForm()
  + showStatistics()
}

' ========== ОСНОВНОЙ КОНТЕКСТ ==========
package "Основной контекст" <<Main>> {

  ' ----- ФАСАД -----
  class GrantSystemFacade <<Facade>> {
    + login(username, password): User
    + logout(): void
    
    ' Заявки
    + createApplication(title, description): GrantApplication
    + submitApplication(appId): void
    + getMyApplications(): List<GrantApplication>
    
    ' Экспертиза
    + submitReview(appId, score, comment): Review
    + getApplicationReviews(appId): List<Review>
    
    ' Гранты
    + approveApplication(appId, amount): Grant
    + rejectApplication(appId, reason): void
    
    ' Статистика
    + getApplicationStats(): ApplicationStats
    + getGrantStats(): GrantStats
  }

  ' ----- РЕПОЗИТОРИИ -----
  interface IUserRepository <<Interface>> {
    + findById(id): User
    + findByEmail(email): User
    + save(user): User
    + delete(user): void
  }
  
  interface IAppRepository <<Interface>> {
    + findById(id): GrantApplication
    + save(app): GrantApplication
    + delete(app): void
    + findByApplicant(id): List<GrantApplication>
  }
  
  interface IReviewRepository <<Interface>> {
    + findById(id): Review
    + save(review): Review
    + findByApplication(id): List<Review>
  }
  
  interface IGrantRepository <<Interface>> {
    + findById(id): Grant
    + save(grant): Grant
    + findByInvestor(id): List<Grant>
  }

  class UserRepository <<Repository>> implements IUserRepository {
    - database
  }
  
  class AppRepository <<Repository>> implements IAppRepository {
    - database
  }
  
  class ReviewRepository <<Repository>> implements IReviewRepository {
    - database
  }
  
  class GrantRepository <<Repository>> implements IGrantRepository {
    - database
  }

  ' ----- АГРЕГАТЫ -----
  package "Агрегат User" {
    class User <<Entity>> {
      + id
      + name
      + email
      + role
      - passwordHash
      + login(): boolean
      + logout(): void
    }
    
    class Applicant <<Entity>> {
      + organization
      + inn
    }
    
    class Expert <<Entity>> {
      + specialty
      + qualification
    }
    
    class Investor <<Entity>> {
      + company
      + budget
    }
    
    User <|-- Applicant
    User <|-- Expert
    User <|-- Investor
  }

  class GrantApplication <<Entity>> {
      + id
      + title
      + description
      + status
      + submissionDate
      + submit(): void
      + getAverageScore(): double
   }

  class Review <<Entity>> {
      + id
      + score
      + comment
      + submissionDate
      + submit(): void
   }

  class Grant <<Entity>> {
      + id
      + amount
      + startDate
      + endDate
      + status
      + approve(): void
      + disburse(): boolean
    }

  ' ----- СВЯЗИ ФАСАДА -----
  GrantSystemFacade --> IUserRepository
  GrantSystemFacade --> IAppRepository
  GrantSystemFacade --> IReviewRepository
  GrantSystemFacade --> IGrantRepository

  ' ----- СВЯЗИ РЕПОЗИТОРИЕВ -----
  IUserRepository --> User
  IAppRepository --> GrantApplication
  IReviewRepository --> Review
  IGrantRepository --> Grant
}

' ========== ВСПОМОГАТЕЛЬНЫЙ КОНТЕКСТ ==========
package "Вспомогательный контекст" <<Support>> {
' ----- СЕРВИСЫ -----
  
  interface INotifyService <<Interface>> {
    + sendNotification(user, message): void
    + sendEmail(to, subject, body): void
  }
  
  interface IPaymentService <<Interface>> {
    + processPayment(grant): boolean
  }

  interface IStatsService <<Interface>> {
    + getAppStats(): AppStats
    + getGrantStats(): GrantStats
    + getUserStats(): UserStats
  }

  class StatsService <<Service>> implements IStatsService {
    - appRepo: IAppRepository
    - userRepo: IUserRepository
    - grantRepo: IGrantRepository
  }
  
  class NotifyService <<Service>> implements INotifyService {
    - emailService: EmailServiceAPI
  }
  
  class PaymentService <<Service>> implements IPaymentService {
    - paymentGatewayAPI
  }

  ' ----- ВНЕШНИЕ СЕРВИСЫ -----

  package "ВНЕШНИЕ API" {
    class EmailServiceAPI {
      + sendEmail(to, subject, body): boolean
    }
  
    class PaymentGatewayAPI {
      + processPayment(amount, recipient): Result
    }
  }

  ' ----- СВЯЗИ СЕРВИСОВ -----
  NotifyService --> EmailServiceAPI
  PaymentService --> PaymentGatewayAPI
  StatsService --> IAppRepository
  StatsService --> IUserRepository
  StatsService --> IGrantRepository
}

' ========== ВНЕШНИЕ СВЯЗИ ==========
' UI → Фасад
GrantSystemUI ..> GrantSystemFacade : вызывает

' Фасад → Сервисы
GrantSystemFacade --> INotifyService
GrantSystemFacade --> IPaymentService
GrantSystemFacade --> IStatsService

' Связи агрегатов
Applicant "1" --> "*" GrantApplication : создает
Expert "1" --> "*" Review : пишет
Investor "1" --> "*" Grant : финансирует
GrantApplication "1" --> "*" Review : содержит
GrantApplication "1" --> "0..1" Grant : порождает

' Упрощенные связи для компактности
hide empty members
hide circle
@enduml
```
