<img width="1503" height="1993" alt="image" src="https://github.com/user-attachments/assets/6fc3a17a-b1da-4692-80d0-b97386b22a9e" />




```
@startuml
title Управление заявкой

actor Applicant
actor Expert

participant GrantSystemUI
participant GrantSystemFacade
participant UserRepository
participant AppRepository
participant NotifyService
participant EmailServiceAPI

== Создание заявки ==
Applicant -> GrantSystemUI : openCreateApplicationForm()
GrantSystemUI -> GrantSystemFacade : createApplication(applicantId, applicationData)
GrantSystemFacade -> UserRepository : findById(applicantId)
UserRepository --> GrantSystemFacade : User
GrantSystemFacade -> AppRepository : save(new GrantApplication)
AppRepository --> GrantSystemFacade : GrantApplication (appId)
GrantSystemFacade --> GrantSystemUI : applicationCreated(appId)

== Верификация заявки ==
Applicant -> GrantSystemUI : saveApplication(appId, updatedData)
GrantSystemUI -> GrantSystemFacade : updateGrantApplication(appId, updatedData)
GrantSystemFacade -> AppRepository : update(GrantApplication)
AppRepository --> GrantSystemFacade : GrantApplication (status="readyForReview")

== Отправка на экспертизу ==
Applicant -> GrantSystemUI : submitApplication(appId)
GrantSystemUI -> GrantSystemFacade : submitApplication(appId)
GrantSystemFacade -> AppRepository : findById(appId)
AppRepository --> GrantSystemFacade : GrantApplication
GrantSystemFacade -> AppRepository : update(status="onReview")

== Уведомления о подаче ==
GrantSystemFacade -> NotifyService : sendNotification(applicantUser,\n "Заявка принята к рассмотрению")
NotifyService -> EmailServiceAPI : sendEmail(toApplicant, subject, body)
GrantSystemFacade -> NotifyService : sendNotification(expertsGroup,\n "Новая заявка для экспертизы")
NotifyService -> EmailServiceAPI : sendEmail(toExperts, subject, body)

== Доработка ==
Applicant -> GrantSystemUI : editApplication(appId)
GrantSystemUI -> GrantSystemFacade : updateGrantApplication(appId, revisedData)
GrantSystemFacade -> AppRepository : update(GrantApplication)
AppRepository --> GrantSystemFacade : GrantApplication
Applicant -> GrantSystemUI : submitApplication(appId)
GrantSystemUI -> GrantSystemFacade : submitApplication(appId)
GrantSystemFacade -> AppRepository : findById(appId)
AppRepository --> GrantSystemFacade : GrantApplication
GrantSystemFacade -> AppRepository : update(status="onReview")

GrantSystemFacade -> NotifyService : sendNotification(applicantUser,\n "Заявка принята к рассмотрению")
NotifyService -> EmailServiceAPI : sendEmail(toApplicant, subject, body)
GrantSystemFacade -> NotifyService : sendNotification(expertsGroup,\n "Новая заявка для экспертизы")
NotifyService -> EmailServiceAPI : sendEmail(toExperts, subject, body)
@enduml
```
