<img width="1112" height="1357" alt="image" src="https://github.com/user-attachments/assets/1baceb23-898e-4f47-897e-c54825b8819f" />



```plantuml
@startuml
skinparam sequence {
  ParticipantBackgroundColor #F5F5F5
  ActorBackgroundColor #E8F5E8
  LifeLineBackgroundColor #FFFFFF
  ArrowColor #444444
}

title Sequence Diagram: Grant Statistics

actor "Applicant" as Applicant
actor "Expert" as Expert
actor "Investor" as Investor
participant "UI" as UI
participant "Facade" as Facade
participant "StatsService" as StatsService
participant "AppRepo" as AppRepo
participant "UserRepo" as UserRepo

' ========== СОИСКАТЕЛЬ ==========
Applicant -> UI : запрос общей статистики
activate Applicant

UI -> Facade : getApplicationStats()
activate UI

Facade -> StatsService : getApplicationStats()
activate Facade

StatsService -> AppRepo : countAll()
activate StatsService
AppRepo --> StatsService : total=156

StatsService -> AppRepo : countByStatus('APPROVED')
activate StatsService
AppRepo --> StatsService : approved=42

StatsService -> AppRepo: sumAmount()
activate StatsService
AppRepo--> StatsService : totalAmount=1250000

StatsService -> AppRepo : calculateAverageScore()
activate StatsService
AppRepo --> StatsService : avgScore=8.2

StatsService --> Facade : ApplicationStats
deactivate StatsService

Facade --> UI : ApplicationStats
deactivate Facade

UI --> Applicant : отображение статистики
activate UI
deactivate UI
deactivate Applicant

' ========== ЭКСПЕРТ ==========
Expert -> UI : запрос персональной статистики
activate Expert

UI -> Facade : getExpertStats(123)
activate UI

Facade -> StatsService : getExpertStats(123)
activate Facade

StatsService -> UserRepo : getExpertStats(123)
activate StatsService
UserRepo --> StatsService : reviews=28, avgScore=7.8

StatsService -> UserRepo : getExpertRanking(123)
activate StatsService
UserRepo --> StatsService : ranking=5

StatsService --> Facade : ExpertStats
deactivate StatsService

Facade --> UI : ExpertStats
deactivate Facade

UI --> Expert : отображение статистики
activate UI
deactivate UI
deactivate Expert

' ========== ИНВЕСТОР ==========
Investor -> UI : запрос финансовой статистики
activate Investor

UI -> Facade : getGrantStats(456)
activate UI

Facade -> StatsService : getGrantStats(456)
activate Facade

StatsService -> AppRepo: getInvestorStats(456)
activate StatsService
AppRepo--> StatsService : grants=15, total=1250000

StatsService -> AppRepo: avgAmountByInvestor(456)
activate StatsService
AppRepo--> StatsService : avgAmount=83333

StatsService -> AppRepo : getUniqueApplicants(456)
activate StatsService
AppRepo --> StatsService : uniqueApplicants=12

StatsService --> Facade : GrantStats
deactivate StatsService

Facade --> UI : GrantStats
deactivate Facade

UI --> Investor : отображение статистики
activate UI
deactivate UI
deactivate Investor

@enduml
