### Рамки. Модуль "Статистика грантов" интегрирован в информационную систему технической экспертизы и предоставляет комплексную аналитику по грантовым заявкам для мониторинга эффективности работы системы и принятия управленческих решений.

### Уровень. Это системная задача, обеспечивающая сбор, обработку и представление статистических данных о грантовых заявках.

### Исполнители 
Основной исполнитель. Основной исполнитель — инвестор, инициирующий запросы статистики и отчетов. 
Второстепенный исполнитель — эксперт, запрашивающий персональную статистику.

### Заинтересованные лица и их требования
- Инвестор. Требует прозрачную статистику по всем грантам, аналитику эффективности распределения средств и возможность генерации отчетов в различных форматах.
- Независимый эксперт. Ожидает доступ к персональной статистике для мониторинга нагрузки, времени рассмотрения заявок и эффективности работы.
- Соискатель гранта. Косвенно заинтересован в прозрачности системы через публичную статистику.

### Предусловия
- Пользователь аутентифицирован в системе и имеет соответствующую роль (Инвестор/Эксперт)
- В системе имеются данные о грантовых заявках для анализа
- Сервисы авторизации и базы данных доступны

### Результаты (Постусловия)
- Статистические данные сформированы и отображены в интерфейсе
- Отчеты сгенерированы в запрошенном формате
- Обеспечен ролевой доступ к статистическим данным
- Все операции залогированы и аудированы

Основной успешный сценарий
- Запрос общей статистики:
  - Инвестор через UI запрашивает статистику с применением фильтров
  - Система проверяет права доступа через AuthorizationService
  - IStatisticsRepository получает агрегированные данные из БД
  - Данные отображаются в удобном формате
- Получение экспертной статистики:
  - Эксперт запрашивает персональную статистику через UI
  - Система валидирует права доступа к персональным данным
  - IStatisticsRepository возвращает статистику по конкретному эксперту
  - Данные отображаются в личном кабинете эксперта
- Генерация отчета
  - Инвестор формирует запрос на отчет с указанием формата
  - IStatisticsRepository создает отчет на основе фильтров
  - Отчет становится доступен для скачивания

### Расширения (альтернативные потоки)
- Отказ в доступе - при неуспешной валидации прав система возвращает ошибку авторизации
- Отсутствие данных - при отсутствии данных за выбранный период система информирует пользователя
- Ошибка генерации отчета - система уведомляет о технической ошибке и предлагает повторить попытку

### Специальные требования
- Интерфейс должен предоставлять интуитивно понятные визуализации данных
- Обязательная поддержка экспорта в форматах PDF, Excel, CSV
- Фильтрация данных по временным периодам, статусам, экспертам
- Высокая производительность при работе с большими объемами данных

### Архитектурные особенности
- GrantStatisticsFacade - единая точка входа для операций со статистикой
- IStatisticsRepository/IGrantApplicationRepository - интерфейсы репозиториев для слабой связанности
- AuthorizationService - централизованная проверка прав доступа
- DTO объекты (Statistics, ExpertStatistics, ReportFile) для передачи данных

### Технологии и данные
- Агрегированные статистические данные (количественные показатели, распределения)
- Параметры фильтрации и форматы отчетов
- SQL-запросы к базе данных grant_applications
- Интеграция с системой аутентификации и авторизации

### Частота использования
- Высокая интенсивность в периоды отчетности и анализа грантовых программ
- Регулярное использование инвесторами для мониторинга
- Ежедневное использование экспертами для самоанализа

### Открытые вопросы
- Какие дополнительные метрики наиболее важны для разных категорий пользователей?
- Требуется ли предварительное кэширование статистических данных?
- Какие типы визуализации наиболее эффективны для представления данных?
