### **Рамки**. Модуль «Управление экспертизой» интегрирован в информационную систему грантового отбора и обеспечивает автоматизированное взаимодействие независимого эксперта с назначенными на него заявками: от получения до финального вердикта.

### **Уровень**. Это экспертная задача, охватывающая полный цикл оценки заявки: от авторизации в системе до отправки заключения и уведомления заинтересованных сторон.

### **Основной исполнитель**. Основной исполнитель — независимый эксперт, назначенный системой на проведение технической экспертизы конкретной грантовой заявки.

### **Заинтересованные лица и их требования**
- **Независимый эксперт**. Ожидает простой интерфейс для просмотра назначенных заявок, доступ к необходимым документам и возможность быстро оформить и отправить экспертное заключение.
- **Соискатель гранта**. Хочет оперативного уведомления о результатах экспертизы, понятного статуса заявки и возможности получить обратную связь при необходимости доработки.
- **Инвестор / администратор системы**. Заинтересован в прозрачности экспертизы, неизменяемой фиксации экспертных вердиктов и автоматической передаче данных в аналитические и финансовые модули.

### **Предусловия**
- Независимый эксперт зарегистрирован и имеет роль «Expert» в системе.
- Заявка назначена эксперту через модуль распределения и имеет статус «Назначена на экспертизу».

### **Результаты (Постусловия)**
- Эксперт успешно прошёл авторизацию и получил доступ к заявкам.
- Эксперт ознакомился с материалами заявки и отправил экспертное заключение.
- Результаты экспертизы сохранены в системе, статус заявки обновлён.
- Соискатель получил уведомление о завершении экспертизы.
- Данные переданы во внешний модуль завершения экспертизы (`ExpertiseServiceAPI`) и в статистический модуль.

### **Основной успешный сценарий**
1. **Авторизация эксперта**  
   Эксперт входит в систему и проходит проверку прав доступа как пользователь с ролью «Expert».

2. **Получение списка назначенных заявок**  
   Система отображает только те заявки, которые назначены данному эксперту и ожидают оценки.

3. **Выбор заявки для оценки**  
   Эксперт выбирает одну из заявок и инициирует процесс её просмотра.

4. **Просмотр документов заявки**  
   Система загружает и отображает полную информацию о заявке: описание проекта, смету, приложенные документы.

5. **Заполнение экспертного заключения**  
   Эксперт заполняет форму заключения: вердикт (одобрено/отклонено), баллы, комментарии.

6. **Отправка результата экспертизы**  
   После подтверждения данные отправляются через фасад, сохраняются в базе и проходят валидацию прав доступа.

7. **Завершение экспертизы**  
   Система вызывает внешний сервис (`ExpertiseServiceAPI`) для финализации и направляет уведомление соискателю.

8. **Обновление статуса**  
   Интерфейс отображает новый статус заявки: «Экспертиза завершена».

### **Расширения (альтернативные потоки)**
1. **Ошибка авторизации**  
   – При отсутствии прав система блокирует доступ и отображает сообщение об ошибке.
2. **Нет назначенных заявок**  
   – Система показывает пустой список и предлагает проверить позже или связаться с администратором.
3. **Сбой при отправке результата**  
   – Система сохраняет черновик локально и предлагает повторную отправку; при повторном сбое — уведомляет администратора.
4. **Необходимость приостановить экспертизу**  
   – Эксперт может сохранить промежуточный результат и вернуться к заявке позже.

### **Специальные требования**
- Все действия эксперта логируются и привязываются к его учётной записи.
- Доступ к заявкам строго ограничен по принципу «только свои назначенные».
- Все данные передаются по зашифрованному каналу (TLS 1.2+).
- Интерфейс должен поддерживать просмотр документов PDF, DOCX без необходимости загрузки.
- Поддержка локализации интерфейса (минимум: русский, английский).

### **Список технологий и типов данных**
- Идентификаторы эксперта (`uInt32`), заявки (`uInt32`), вердикт (`enum`), комментарии (`string`), дата оценки (`DateTime`).
- Интеграция с `AuthorizationService`, `NotificationService`, внешним `ExpertiseServiceAPI`.
- Хранение документов и метаданных в защищённой базе данных с аудитом изменений.

### **Частота использования**
- Средняя/высокая в периоды активного грантового отбора; пиковая нагрузка при массовом назначении экспертиз.

### **Открытые вопросы**
- Требуется ли двухфакторная аутентификация для экспертов?
- Должна ли система поддерживать возможность коллективной экспертизы (несколько экспертов по одной заявке)?
- Нужно ли разрешать эксперту прикреплять дополнительные файлы к заключению?
